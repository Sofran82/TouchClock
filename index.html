<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=11">
<title>TouchClock</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: black;
    font-family: "Segoe UI", Arial, sans-serif;
}

#clock {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    text-align: center;
    color: #00ff00;
}

#time {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    white-space: nowrap;
    font-family: "Segoe UI", Arial, sans-serif;
    font-weight: 600; 
    text-shadow:
        1px 0 0 currentColor,
       -1px 0 0 currentColor,
        0 1px 0 currentColor,
        0 -1px 0 currentColor;
}

#settingsButton {
    position: absolute;
    bottom: 20px;
    right: 20px;
    font-size: 32px;
    padding: 20px 28px;
    background: #222;
    color: white;
    border: none;
    cursor: pointer;
    touch-action: manipulation;
    z-index: 1001;
    border-radius: 6px;
}

#settings {
    position: absolute;
    bottom: 70px;
    right: 20px;
    background: #111;
    color: white;
    padding: 15px;
    display: none;
    font-size: 18px;
    z-index: 1000;
}

#settings div {
    margin-top: 10px;
}

input, select {
    font-size: 18px;
    width: 130px;
}
</style>
</head>

<body>

<div id="clock">
    <div id="time">
        <span id="hours">00</span><span id="colon">:</span><span id="minutes">00</span>
    </div>
</div>

<button id="settingsButton">⚙</button>

<div id="settings">
    <div>
        Alarmfärg (hex):<br>
        <input type="text" id="alarmColor">
    </div>
    <div>
        Blinkande kolon:<br>
        <select id="colonBlink">
            <option value="true">Ja</option>
            <option value="false">Nej</option>
        </select>
    </div>
    <div>
        Textstorlek (% av skärmen):<br>
        <input type="number" id="textSize" min="10" max="100">%
    </div>
    <div>
        Larm starttid (HH:MM):<br>
        <input type="time" id="alarmStart">
    </div>
    <div>
        Larm sluttid (HH:MM):<br>
        <input type="time" id="alarmEnd">
    </div>
</div>

<script>
var showColon = true;
var blinkColon = true;
var textSizePercent = 0.9; // dubbelt så stor som tidigare 0.45
var alarmColor = "#00ff00";
var normalColor = "#00ff00";
var hideSettingsTimer = null;
var alarmStart = "06:00";
var alarmEnd = "08:00";

// --- Load saved settings ---
if (localStorage.getItem("alarmColor")) {
    alarmColor = localStorage.getItem("alarmColor");
    document.getElementById("alarmColor").value = alarmColor;
} else {
    document.getElementById("alarmColor").value = alarmColor;
}

if (localStorage.getItem("blinkColon")) {
    blinkColon = localStorage.getItem("blinkColon") === "true";
    document.getElementById("colonBlink").value = blinkColon ? "true" : "false";
}

if (localStorage.getItem("textSizePercent")) {
    textSizePercent = parseFloat(localStorage.getItem("textSizePercent"));
    document.getElementById("textSize").value = Math.round(textSizePercent * 100);
} else {
    document.getElementById("textSize").value = Math.round(textSizePercent * 100);
}

if (localStorage.getItem("alarmStart")) {
    alarmStart = localStorage.getItem("alarmStart");
}
document.getElementById("alarmStart").value = alarmStart;

if (localStorage.getItem("alarmEnd")) {
    alarmEnd = localStorage.getItem("alarmEnd");
}
document.getElementById("alarmEnd").value = alarmEnd;

// --- Layout ---
function updateLayout() {
    var w = document.documentElement.clientWidth;
    var h = document.documentElement.clientHeight;
    var size = Math.min(w, h) * textSizePercent;
    document.getElementById("time").style.fontSize = size + "px";
}

// --- Time update ---
function updateTime() {
    var d = new Date();
    var h = d.getHours();
    var m = d.getMinutes();
    var hhmm = (h < 10 ? "0" : "") + h + ":" + (m < 10 ? "0" : "") + m;

    document.getElementById("hours").textContent = (h < 10 ? "0" : "") + h;
    document.getElementById("minutes").textContent = (m < 10 ? "0" : "") + m;

    if(blinkColon){
        showColon = !showColon;
        document.getElementById("colon").style.visibility = showColon ? "visible" : "hidden";
    } else {
        document.getElementById("colon").style.visibility = "visible";
    }

    // ändra färg om inom larmtid
    if(hhmm >= alarmStart && hhmm <= alarmEnd){
        document.getElementById("clock").style.color = alarmColor;
    } else {
        document.getElementById("clock").style.color = normalColor;
    }
}

// --- Show settings ---
function showSettings() {
    var s = document.getElementById("settings");
    s.style.display = "block";

    if (hideSettingsTimer) clearTimeout(hideSettingsTimer);
    hideSettingsTimer = setTimeout(function () {
        s.style.display = "none";
    }, 5000);
}

var btn = document.getElementById("settingsButton");
btn.onclick = showSettings;
btn.ontouchstart = showSettings;

// --- Settings events ---
document.getElementById("alarmColor").onchange = function () {
    var v = this.value;
    if(/^#[0-9A-Fa-f]{6}$/.test(v)){
        alarmColor = v;
        localStorage.setItem("alarmColor", alarmColor);
    }
};

document.getElementById("colonBlink").onchange = function() {
    blinkColon = this.value === "true";
    localStorage.setItem("blinkColon", blinkColon);
};

document.getElementById("textSize").onchange = function() {
    var val = parseInt(this.value);
    if(!isNaN(val) && val >= 10 && val <= 100){
        textSizePercent = val / 100;
        localStorage.setItem("textSizePercent", textSizePercent);
        updateLayout();
    }
};

document.getElementById("alarmStart").onchange = function() {
    alarmStart = this.value;
    localStorage.setItem("alarmStart", alarmStart);
};

document.getElementById("alarmEnd").onchange = function() {
    alarmEnd = this.value;
    localStorage.setItem("alarmEnd", alarmEnd);
};

// --- Init ---
window.onresize = updateLayout;
updateLayout();
updateTime();
setInterval(updateTime, 1000);
</script>

</body>
</html>
