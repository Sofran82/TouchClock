<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>TouchClock</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    background: black;
    color: #e0e0e0;
    font-family: "Trebuchet MS", sans-serif;
    overflow: hidden;
}

#clock {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 28vmin;
    user-select: none;
}

#settingsBtn {
    position: absolute;
    top: 3vmin;
    right: 3vmin;
    font-size: 4vmin;
    padding: 1vmin 2vmin;
    display: none;
}

#settings {
    position: absolute;
    inset: 0;
    background: black;
    color: white;
    display: none;
    padding: 6vmin;
    font-size: 4vmin;
}

label {
    display: block;
    margin-bottom: 4vmin;
}
</style>
</head>
<body onclick="showButton()">

<div id="clock">
    <span id="hours">00</span><span id="colon">:</span><span id="minutes">00</span>
</div>

<button id="settingsBtn" onclick="openSettings()">Inställningar</button>

<div id="settings">
    <label>Start:
        <input type="time" id="colorStart">
    </label>
    <label>Slut:
        <input type="time" id="colorEnd">
    </label>
    <label>Larmfärg:
        <input type="color" id="alarmColor">
    </label>
    <button onclick="closeSettings()">Stäng</button>
</div>

<script>
var hideTimer;

function updateClock(){
    var now = new Date();
    var h = ("0"+now.getHours()).slice(-2);
    var m = ("0"+now.getMinutes()).slice(-2);
    var s = now.getSeconds();

    document.getElementById("hours").innerHTML = h;
    document.getElementById("minutes").innerHTML = m;
    document.getElementById("colon").style.visibility = (s % 2 === 0) ? "visible" : "hidden";

    applyAlarmColor(now);
}

function applyAlarmColor(now){
    var start = toMin(document.getElementById("colorStart").value);
    var end = toMin(document.getElementById("colorEnd").value);
    var cur = now.getHours()*60 + now.getMinutes();

    var active = start < end
        ? cur >= start && cur < end
        : cur >= start || cur < end;

    var color = active
        ? document.getElementById("alarmColor").value
        : "#e0e0e0";

    document.getElementById("clock").style.color = color;
}

function toMin(t){
    var p = t.split(":");
    return parseInt(p[0])*60 + parseInt(p[1]);
}

function showButton(){
    var btn = document.getElementById("settingsBtn");
    btn.style.display = "block";
    clearTimeout(hideTimer);
    hideTimer = setTimeout(function(){
        btn.style.display = "none";
    }, 5000);
}

function openSettings(){
    document.getElementById("settings").style.display = "block";
}

function closeSettings(){
    saveSettings();
    document.getElementById("settings").style.display = "none";
}

function saveSettings(){
    localStorage.colorStart = document.getElementById("colorStart").value;
    localStorage.colorEnd = document.getElementById("colorEnd").value;
    localStorage.alarmColor = document.getElementById("alarmColor").value;
}

function loadSettings(){
    document.getElementById("colorStart").value = localStorage.colorStart || "22:00";
    document.getElementById("colorEnd").value = localStorage.colorEnd || "06:00";
    document.getElementById("alarmColor").value = localStorage.alarmColor || "#ff5555";
}

loadSettings();
updateClock();
setInterval(updateClock, 1000);
</script>

</body>
</html>
